## 第一章

- **分布式系统的定义**
  
  分布式系统是由多个通过 **网络互连** 的 **独立自治** 的计算节点组成，这些计算节点为了完成 **共同目标** 基于 **消息传递机制** 进行 **相互协作** 
  
  - 要点：偏重于理解
  
    > 计算节点：节点可以是进程，线程，对象，组件，服务，计算机或一组计算机
    >
    > 网络互连：逻辑拓扑上是全连接网络
    >
    > 独立自治：独立 CPU 独立 **时钟**，并发，独立错误
    >
    > 完成共同目标
    >
    > 相互协作
    >
    > 消息传递：非内存共享
  
- **几种构架模式**
  
  - 客户端-服务器
  
    > **客户端发出请求，服务器完成运算**，客户端运算任务轻，服务端运算任务重，客户端生命周期短，服务端生命周期长
  
  - 主从
  
    - Master：负责将总计算任务分解为多个子任务分发给各个从节点完成
    - 主节点监控各个节点的任务执行情况，失败的任务调度给其他从节点
  
  - 总线模式
  
    - **节点通过虚拟总线相连**
    - **发送者和接受者不必互相知道彼此**
    - 采用异步方式通信
    - **节点完成不同功能，分工协作**
  
  - 对等
  
    - 计算节点在任务分工上是完全对等的
    - 软件完全相同，只是初始化参数不同
      - 结构化：交互遵循固定规律
      - 非结构化：交互模式没有固定规律
  
  - ==服务器端用集群，分成三层，每层的作用是什么，为什么要分层==
    
    **服务器端多个节点构成，共同分担计算任务，宏观逻辑上，多个服务器构成的集群可以视为单一的功能更强大的计算节点**
    
    > - **表示层：用户视图和控制**
    > - **应用层：应用逻辑**
    > - **数据层：数据库管理**
    
    - 不同的层做不同的事情
    - 不同的层之间界面化，不会相互影响，解耦，改变其中一层，不影响其他两层
  
- **负载均衡**
  
  - 几种负载均衡策略
    
    - 随机：每次随机选择一个服务器进行处理
    - 轮询：
    - 固定权重值
    
    - IP 哈希：**基于==一致性随机散列函数==** 一定要搞明白，如何实现负载均衡的
    
      > 算法根据请求的源IP地址，作为散列键(Hash Key)从静态分配的散列表找出对应的服务器，若该服务器是可用的且未超载的，则将请求发送到该服务器，否则返回空。
    
    - 最少 TCP 连接数
    
    - 最小响应时间
    
    - 基于各服务器实际负载，进行动态负载均衡
  
- 中间件
  - 什么是中间件
  
    > 中间件是一类连接软件组件和应用的计算机软件，介于应用层和操作系统中间，为应用层提供服务
  
  - 中间件的作用
  
    > 为开发者提供的高层次的编程抽象，屏蔽分布式系统底层的异构性和复杂性
    >
    > 提高互操作性和可移植性
    >
    > 提供分布式系统的基础设施服务
  
  - 常用的中间件有哪些
  
    - 远程过程调用
    - 分布式对象
    - 分布式组件
    - 消息队列
    - Web 服务
    - P2P
  
    
  
- 抽象理论模型（理解）
  
  - 交互模式
  
    > 定义算法运行期间哪些节点之间有消息传递动作
  
    - **同步模式**
    - **异步模式**
  
  - 节点故障模式
    - **失效停止**
    - 失效停止重启模式
    - **拜占庭模式**
  - 信道故障模式
    - 消息是否会丢失
    - 消息是否会乱序
    - 消息传输延迟的上限





## 第二章 节点之间的通信技术

- socket
  
  > socket 是传输层和网络层提供给应用层的标准化编程接口
  >
  > - 流式套接字 **面向连接**
  > - 数据报套接字 **无连接**
  > - 原始套接字
  
  - **实现节点间通信时关注并发服务问题**
    
    - 基于多线程的并发服务技术
    - 基于线程池的并发服务技术 **重用存在的线程，减少对象创建、消亡的开销，性能佳**
    - 事件驱动技术（多路复用技术） **适用于处理大量短事务的应用场景**
    
    - 每个并发服务的特点，优点，缺点在什么地方
    - 长事务适合用哪种并发服务
    - 短事务呢
  
- RPC
  
  > 使应用程序可以像调用本地节点上的过程那样去调用一个远程节点上的过程
  
  - 原理
    
    RPC/RMI 中间件在调用者进程中植入 stub 模块，stub 模块作为远程过程中的本地代理，暴露与远程过程相同的接口
    
    中间件在被调用者进程中植入 skeleton 模块，skeleton 作为调用者在远程主机中的代理
    
    stub 模块与 skeleton 模块利用 Socket 进行通信
    
    - 如何一层一层参数序列化
    - 中间件如何配合
      - 对图的理解，RPC的原理， Stub、Skeleton 做什么
  
- 消息中间件
  - 理解他的特点
  
    面向消息中间件提供了一种分布式消息队列服务，节点之间可以实现基于消息的形式灵活的**异步**通信
  
    - 异步：发送方任意时刻发出消息，不必等待成功，接收方不必以等待方式等待消息的到来
  
  - 两种模式
    - 发布订阅：
    
      > 向一个特定的消息主题发布消息，多个订阅者可以同时关注并接收来自特定消息主题的消息
      >
      > - 实现广播、组播、多对多通信模式
      > - 支持持久性，事务机制等高级功能
    
    - 点对点
    
      > 消息生产者和消费者之间的点对点通信，相当于生产者和消费者之间建立了一个点对点消息队列
      >
      > - 每个消息只有一个消费者，不可重复消费
      > - 高级队列模式：带优先级的队列，支持持久性的队列
    
  - 作用，优点
    - 实现异步通信
    - 分布式节点之间的解耦
    - 保证可靠递交
    - 广播、组播、多对多
    - 削峰，流控
    - **Push 模型和 Pull 模型**：push从服务器发出请求给客户端，客户端接收数据，pull:客户端去请求服务端，获取服务端的数据。
  
- Web Service
  - 涉及到很多协议
    - 消息编码标准：XML
    - 传输协议标准：HTTP、SMTP、TCP、UDP
    - 远程对象访问协议：SOAP（simple Object Access Protocol）
    - Web 服务描述语言： WSDL，描述接口定义
    - 服务注册、发现、目录：UDDL
    - 安全不用看





## 第三章 分布式文件系统

- HDFS
  
  > 分布式系统中多个节点的存储资源整合在一起，向用户呈现统一的存储空间和文件系统目录树，用户无需关心数据存放在哪个节点上
  
  - 理解
    - 主节点的功能
    
      **文件系统元数据管理、数据节点管理，多副本维护，存储负载均衡**
    
    - 从节点
    
      **存储文件内容，建立 block id 到 datanode 本地文件的映射关系，文件内容保存到磁盘**
    
      
    
    - 读数据是怎么读的
    
      - 维护两张表
      - **文件名和数据块号**
      - 每个数据块给哪几个节点备份过
    
    - 怎么使用
      
      - 巨大的文件系统，能够读写文件



## 第四章 MR 模型

不考简答了，给几个任务来设计，在 MAP阶段的逻辑是什么，输入是什么，输出的是什么，REDUCE 阶段输入输出

- Combine 阶段，局部聚合也要能说出来



## 第五章 时钟和分布式共识

- 时钟

  - Cristain **时间同步算法** 重点
    
    - 怎么算，给你四个时间，公式怎么推
    
      > 网络往返传输延迟：(T4-T1)-(T3-T2)
      >
      > 客户端时间设置为：T3+二分之一网络往返传输延迟
  - 逻辑时钟
    
    - 主要思想是什么，怎么维护的
    
      - 分布式系统无法用物理时钟来对事情的发生顺序进行排序
      - 关键在不同节点对多个事件的 **发生顺序达成一致** ，达成的顺序 **不能破坏因果关系**
    
      - **维护**
        - 节点维护一个不断增加的整数作为逻辑时钟
        - 节点内事件的发生会触发逻辑时钟的增长
        - 节点发出的每个消息都绑定一个二元组 ：本地逻辑时钟号，节点 ID 号
        - 每发生一个新事件就上本地逻辑时钟加1
        - 节点接受到一个消息之后将本地逻辑时钟调整为本地时钟和对方逻辑时钟的最大值加1

- 分布式共识 不考细节的东西了，常识？

  